# Docwise Bot - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∏—Ö –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ YandexGPT –∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

-   üìö –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament
-   ü§ñ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å YandexGPT –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
-   üí¨ Telegram-–±–æ—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
-   üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π markdown
-   üé® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
-   üë• –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π
-   üîç –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

-   PHP 8.2+
-   Laravel 12+
-   MySQL 8.0+
-   Composer
-   YandexGPT API –∫–ª—é—á
-   Telegram Bot Token

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

```bash
git clone https://github.com/void-environment/docwise.git
cd docwise
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
sudo apt update
sudo apt install php8.3-xml php8.3-dom
sudo apt install php8.3-pgsql
sudo apt install postgresql postgresql-contrib
sudo apt install -y postgresql-server-dev-16 build-essential
```

```bash
git clone https://github.com/pgvector/pgvector.git
cd pgvector
make
sudo make install
cd ../
rm -rf pgvector
```

```bash
sudo -u postgres psql
```

```sql
CREATE USER docwise WITH PASSWORD 'password';
CREATE DATABASE docwise OWNER docwise;
GRANT ALL PRIVILEGES ON DATABASE docwise TO docwise; -- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
\q
```

```bash
psql -h 127.0.0.1 -U docwise -d docwise # -- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

```bash
sudo -u postgres psql -d docwise -c "CREATE EXTENSION vector;"
```

```bash
sudo systemctl restart postgresql
```

```bash
composer install
npm install
```

```bash
sudo apt-get install libreoffice
```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**

```bash
cp .env.example .env
php artisan key:generate
```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ .env:**

```env
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=docwise
DB_USERNAME=docwise
DB_PASSWORD=password
```

5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ YandexGPT –≤ .env:**

```env
YANDEX_GPT_API_KEY=–≤–∞—à_api_–∫–ª—é—á
YANDEX_GPT_FOLDER_ID=–≤–∞—à_folder_id
```

6. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram Bot –≤ .env:**

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_bot_token
```

7. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**

```bash
php artisan migrate
```

8. **–ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–¥–ª—è Docker):**

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
docker exec backend-vue-chat-template /var/www/backend/fix-permissions.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
docker exec backend-vue-chat-template chown -R www-data:www-data /var/www/backend/storage
docker exec backend-vue-chat-template chown -R www-data:www-data /var/www/backend/bootstrap/cache
docker exec backend-vue-chat-template chmod -R 775 /var/www/backend/storage
docker exec backend-vue-chat-template chmod -R 775 /var/www/backend/bootstrap/cache
```

9. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–∞:**

```bash
php artisan make:filament-user
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ YandexGPT

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Yandex Cloud Console](https://console.cloud.yandex.ru/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ —Å–µ—Ä–≤–∏—Å "Yandex Foundation Models"
4. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á –≤ —Ä–∞–∑–¥–µ–ª–µ "–°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã"
5. –ü–æ–ª—É—á–∏—Ç–µ Folder ID –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/botfather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
3. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env —Ñ–∞–π–ª
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ polling:

```bash
php artisan telegram:polling
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–æ–∑–¥–∞–Ω–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–î–æ–∫—É–º–µ–Ω—Ç—ã"
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:
    - –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    - –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    - –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç
    - –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ù–∞–∂–º–∏—Ç–µ "–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏" –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è

### Telegram Bot

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

-   `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø—Ä–∞–≤–∫–∞
-   `/docs` - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
-   `/ask [–≤–æ–ø—Ä–æ—Å]` - –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```
/ask –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?
/ask –ö–∞–∫–∏–µ –µ—Å—Ç—å –≤–∏–¥—ã –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π?
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ Console/Commands/          # Telegram –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ TelegramStartCommand.php
‚îÇ   ‚îú‚îÄ‚îÄ TelegramDocumentCommand.php
‚îÇ   ‚îî‚îÄ‚îÄ TelegramAskCommand.php
‚îú‚îÄ‚îÄ Filament/Resources/        # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ DocumentResource.php
‚îú‚îÄ‚îÄ Jobs/                      # –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îî‚îÄ‚îÄ ProcessDocumentEmbeddings.php
‚îú‚îÄ‚îÄ Models/                    # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ Document.php
‚îÇ   ‚îú‚îÄ‚îÄ DocumentEmbedding.php
‚îÇ   ‚îî‚îÄ‚îÄ User.php
‚îî‚îÄ‚îÄ Services/                  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    ‚îú‚îÄ‚îÄ YandexGptService.php
    ‚îî‚îÄ‚îÄ DocumentService.php
```

## API Endpoints

### YandexGPT Integration

-   **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏:** `POST /foundationModels/v1/textEmbedding`
-   **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤:** `POST /foundationModels/v1/completion`

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤

-   üìÑ `.txt` - –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã
-   üìÑ `.pdf` - PDF –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
-   üìÑ `.docx` - Word –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ –≤ development —Ä–µ–∂–∏–º–µ:

```bash
# –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
php artisan serve

# –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤ –æ—á–µ—Ä–µ–¥–∏
php artisan queue:work

# –ó–∞–ø—É—Å–∫ Telegram polling
php artisan telegram:polling

# –ò–ª–∏ –≤—Å—ë —Å—Ä–∞–∑—É:
composer run dev
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è:

-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
-   –í —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏
-   –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `DocumentService`:

-   `$chunkSize` - —Ä–∞–∑–º–µ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000 —Å–∏–º–≤–æ–ª–æ–≤)
-   `$overlap` - –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 200 —Å–∏–º–≤–æ–ª–æ–≤)
-   `$limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –ò–ò –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

-   –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–Ω–æ–≥–æ markdown —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ HTML —Å Tailwind CSS —Å—Ç–∏–ª—è–º–∏
-   –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML —Ç–µ–≥–æ–≤

### Telegram Bot

-   –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è markdown –≤ —á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç —Å —ç–º–æ–¥–∑–∏
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
-   –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

-   `**–∂–∏—Ä–Ω—ã–π**` ‚Üí üî∏ –∂–∏—Ä–Ω—ã–π (Telegram) / **–∂–∏—Ä–Ω—ã–π** (Web)
-   `# –ó–∞–≥–æ–ª–æ–≤–æ–∫` ‚Üí üìå –ó–∞–≥–æ–ª–æ–≤–æ–∫ (Telegram) / H1 –∑–∞–≥–æ–ª–æ–≤–æ–∫ (Web)
-   `` `–∫–æ–¥` `` ‚Üí üíª –∫–æ–¥ (Telegram) / `–∫–æ–¥` (Web)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [FORMATTING_README.md](FORMATTING_README.md)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
php artisan test:telegram-formatting

# –¢–µ—Å—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
php artisan test:chat-formatting --user-id=1
```

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

-   üóÑÔ∏è –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (Qdrant/Weaviate)
-   üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
-   üîß –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
-   üåê API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

## –¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `storage/logs/laravel.log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –∫–ª—é—á–µ–π
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
